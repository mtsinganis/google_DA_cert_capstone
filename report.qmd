---
title: "Case Study: How Does a Bike-Share Navigate Speedy Success?"
author: "Markos Tsinganis"
format: html
editor: visual
---

## 1. Ask

Financial analysts at Cyclistic have determined that annual members are more profitable than casual riders. The director of marketing believes future growth depends on maximizing the number of annual members. Our business problem is how to convince more potential clients to purchase an annual membership, rather than use our services for casual rides. In order to solve this business problem we need to design a new marketing strategy that will be informed by trends in the historical bike trip data. The current report has the following business task:

**How do annual members and casual riders use Cyclistic bikes differently?**

### Key stakeholders

## 2. Prepare

I will be using [Cyclistic's historical trip data](https://divvy-tripdata.s3.amazonaws.com/index.html) that have been made available by Motivate International Inc. under this [license](https://ride.divvybikes.com/data-license-agreement). The license includes the right to "access, reproduce, analyze, copy, modify, distribute in your product or service and use the Data for any lawful purpose". The bike trip data is organized in a directory containing zipped .csv files. Based on the file names we can deduce that they cover the period 2013 to 2022, with data from the last two years being published on a monthly basis. I will limit myself to the data from the most recent 12 months available (November 2021 - October 2022). The files in this time range use a consistent naming format ('YYYYMM-divvy-tripdata.zip') which makes it easy to download the files programmatically. As a result, I need to download 12 .zip files containing 12 separate .csv files.

A brief look at the file sizes suggests that importing these into RStudio and combining them in one dataframe can potentially crash the program or slow it down considerably. I therefore choose to avoid importing all the data in RStudio, but instead download the .csv files in my computer and save them as separate tables in a new SQLite database. I then use R to send SQL queries to the database to retrieve only the data I need for a particular analysis.

-   Where is your data located?
-   How is the data organized?
-   Are there issues with bias or credibility in this data? Does your data ROCCC?
-   How are you addressing licensing, privacy, security, and accessibility?
-   How did you verify the data's integrity?
-   How does it help you answer your question?
-   Are there any problems with the data?

Load required packages

```{r load libraries}
library(dplyr)
library(here)
library(stringr)
library(tidyr)
library(readr)
```


```{r}
csv_sizes <- tibble(file = list.files(here("raw_data")),
                    size = file.size(list.files(here("raw_data"),
                                                full.names = TRUE))) %>% 
               mutate(size_mb = size / 1048576)

library(ggplot2)
library(stringr)

my_labels <- sapply(csv_sizes$file, function(m) str_replace(m,
                                                pattern = "(.{4})(.{2})(.*)",
                                                replacement = paste("\\1-\\2")))

csv_sizes %>% 
    ggplot(aes(x = file, y = size_mb, group = 1)) + geom_line() +
    labs(title = paste0("Total size of files is ",
                        csv_sizes %>% summarize(round(sum(size_mb), 0)) %>% 
                            pull(), " MB")) +
    theme(axis.text.x = element_text(angle = 45)) +
    scale_x_discrete(labels = my_labels)


```



## 3. Process

## 4. Analyze

**knitr::opts_chunk\$set(fig.path = here::here("figs"))**

## 5. Share

## 6. Act
